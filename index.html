<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Where Are We Eating?</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background: #f4f4f4;
      margin: 0;
      padding: 20px;
    }

    h1 {
      margin-bottom: 10px;
    }

    .filters {
      margin-bottom: 20px;
    }

    select, button, label {
      margin: 5px;
      padding: 6px 10px;
      font-size: 14px;
    }

    canvas {
      background: white;
      border-radius: 50%;
      margin-top: 20px;
    }

    #result {
      margin-top: 20px;
      font-size: 22px;
      font-weight: bold;
      min-height: 30px;
    }

    .arrow {
      font-size: 40px;
      margin-top: 10px;
    }

    button {
      cursor: pointer;
      border: none;
      border-radius: 5px;
      background: #333;
      color: white;
    }

    button:hover {
      background: #555;
    }
  </style>
</head>
<body>

<h1>üçΩÔ∏è Where Are We Eating?</h1>

<div class="filters">
  <select id="cuisine">
    <option value="">All Cuisines</option>
  </select>

  <select id="price">
    <option value="">All Prices</option>
    <option value="$">$</option>
    <option value="$$">$$</option>
    <option value="$$$">$$$</option>
  </select>

  <select id="area">
    <option value="">All Areas</option>
  </select>

  <label>
    <input type="checkbox" id="outdoor"> Outdoor Seating
  </label>

  <br>
  <button onclick="applyFilters()">Apply Filters</button>
  <button onclick="spinWheel()">Spin The Wheel üéØ</button>
</div>

<div class="arrow">‚¨áÔ∏è</div>
<canvas id="wheel" width="400" height="400"></canvas>

<div id="result"></div>

<script>

const restaurants = [
  { name: "Din Tai Fung", cuisine: "Taiwanese", price: "$$", area: "Torrance", outdoor: false },
  { name: "Sushi Gen", cuisine: "Japanese", price: "$$$", area: "LA", outdoor: false },
  { name: "King Mediterrano", cuisine: "Mediterranean", price: "$$", area: "Torrance", outdoor: true },
  { name: "In-N-Out", cuisine: "American", price: "$", area: "South Bay", outdoor: false },
  { name: "Tacos El Goloso", cuisine: "Mexican", price: "$", area: "Torrance", outdoor: true },
  { name: "North Italia", cuisine: "Italian", price: "$$", area: "El Segundo", outdoor: true }
];

let filteredRestaurants = [...restaurants];
const canvas = document.getElementById("wheel");
const ctx = canvas.getContext("2d");
let currentRotation = 0;

function populateFilters() {
  const cuisines = [...new Set(restaurants.map(r => r.cuisine))];
  const areas = [...new Set(restaurants.map(r => r.area))];

  cuisines.forEach(c => {
    const option = document.createElement("option");
    option.value = c;
    option.textContent = c;
    document.getElementById("cuisine").appendChild(option);
  });

  areas.forEach(a => {
    const option = document.createElement("option");
    option.value = a;
    option.textContent = a;
    document.getElementById("area").appendChild(option);
  });
}

function applyFilters() {
  const cuisine = document.getElementById("cuisine").value;
  const price = document.getElementById("price").value;
  const area = document.getElementById("area").value;
  const outdoor = document.getElementById("outdoor").checked;

  filteredRestaurants = restaurants.filter(r => {
    return (!cuisine || r.cuisine === cuisine) &&
           (!price || r.price === price) &&
           (!area || r.area === area) &&
           (!outdoor || r.outdoor === true);
  });

  drawWheel();
  document.getElementById("result").textContent = "";
}

function drawWheel() {
  const count = filteredRestaurants.length;
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  if (count === 0) {
    ctx.font = "20px Arial";
    ctx.fillText("No Results", 140, 200);
    return;
  }

  const angle = (2 * Math.PI) / count;

  filteredRestaurants.forEach((r, i) => {
    ctx.beginPath();
    ctx.moveTo(200, 200);
    ctx.arc(200, 200, 200, i * angle, (i + 1) * angle);
    ctx.fillStyle = `hsl(${i * 360 / count}, 70%, 60%)`;
    ctx.fill();
    ctx.save();
    ctx.translate(200, 200);
    ctx.rotate(i * angle + angle / 2);
    ctx.textAlign = "right";
    ctx.fillStyle = "black";
    ctx.font = "14px Arial";
    ctx.fillText(r.name, 180, 5);
    ctx.restore();
  });
}

function spinWheel() {
  if (filteredRestaurants.length === 0) return;

  const spinAngle = Math.random() * 360 + 720;
  const spinDuration = 3000;
  const start = performance.now();
  const initialRotation = currentRotation;

  function animate(now) {
    const elapsed = now - start;
    const progress = Math.min(elapsed / spinDuration, 1);
    const ease = 1 - Math.pow(1 - progress, 3);
    currentRotation = initialRotation + spinAngle * ease;

    ctx.setTransform(1, 0, 0, 1, 0, 0);
    ctx.translate(200, 200);
    ctx.rotate(currentRotation * Math.PI / 180);
    ctx.translate(-200, -200);

    drawWheel();

    if (progress < 1) {
      requestAnimationFrame(animate);
    } else {
      determineWinner();
    }
  }

  requestAnimationFrame(animate);
}

function determineWinner() {
  const count = filteredRestaurants.length;
  const anglePerSlice = 360 / count;
  const normalizedRotation = currentRotation % 360;
  const winningIndex = Math.floor((360 - normalizedRotation) / anglePerSlice) % count;
  const winner = filteredRestaurants[winningIndex];

  document.getElementById("result").textContent = `üéâ Tonight: ${winner.name}!`;
}

populateFilters();
drawWheel();

</script>

</body>
</html>
